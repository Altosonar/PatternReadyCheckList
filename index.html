<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Pattern Development Request Form</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.5;
            min-height: 100vh;
            padding: 0;
        }
        
        /* App container - expand to maximum width with no padding */
        .app-container {
            width: 100vw;
            max-width: 100%;
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        /* Enhanced Header styling */
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%);
            color: white;
            padding: 20px;
            text-align: center;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
        }
        
        /* Enhanced Progress Design - Single clean progress indicator */
        .progress-container {
            position: relative;
            width: 90%;
            max-width: 800px;
            margin: 0 auto 10px;
            height: 70px;
        }
        
        .progress-line {
            position: absolute;
            top: 35px;
            left: 0;
            right: 0;
            height: 4px;
            background-color: rgba(255, 255, 255, 0.2);
            z-index: 1;
            border-radius: 2px;
        }
        
        .progress-fill {
            position: absolute;
            top: 35px;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, #3498db 0%, #2980b9 100%);
            z-index: 2;
            transition: width 0.5s ease;
            border-radius: 2px;
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
            z-index: 3;
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90px;
            cursor: pointer;
        }
        
        .progress-step-circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
            margin-bottom: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .progress-step-circle.completed {
            background-color: #3498db;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }
        
        .progress-step-circle.active {
            background-color: #2980b9;
            border-color: #2980b9;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.5);
            transform: scale(1.1);
        }
        
        .progress-step-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            line-height: 1.2;
            max-width: 80px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .progress-step-label.active {
            color: white;
            font-weight: 600;
            transform: translateY(2px);
        }
        
        .progress-step-label.completed {
            color: rgba(255, 255, 255, 0.9);
        }
        
        .progress-text {
            position: relative;
            z-index: 2;
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 5px;
            font-weight: 500;
        }
        
        /* Main content area */
        .main-content {
            display: flex;
            flex: 1;
            min-height: 0;
            height: calc(100vh - 180px);
        }
        
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
                height: auto;
            }
        }
        
        /* Enhanced Form section - cleaner design */
        .form-section {
            flex: 1;
            background: white;
            padding: 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            overflow-y: auto;
            position: relative;
            min-height: 600px;
            display: flex;
            flex-direction: column;
        }
        
        /* Form content container - ensures consistent height across sections */
        .form-section-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: none;
            background: #fff;
        }
        
        .form-section-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0.7; }
            to { opacity: 1; }
        }
        
        /* Enhanced Preview section */
        .preview-section {
            flex: 1;
            background: white;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            min-height: 600px;
            border-left: 1px solid #eaeaea;
        }
        
        @media (max-width: 1024px) {
            .form-section, .preview-section {
                min-height: 500px;
            }
            
            .preview-section {
                border-left: none;
                border-top: 1px solid #eaeaea;
            }
        }
        
        .preview-container {
            flex: 1;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            background: #f9f9f9;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        
        /* Section title styling - cleaner design */
        .section-title {
            color: #2c3e50;
            font-size: 1.5rem;
            margin: 0 0 25px 0;
            padding-bottom: 12px;
            border-bottom: 2px solid #ecf0f1;
            display: flex;
            align-items: center;
        }
        
        .section-title .icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background-color: #3498db;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 3px 6px rgba(52, 152, 219, 0.3);
        }
        
        /* Enhanced Form elements */
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 0.95rem;
        }
        
        .form-group .hint {
            font-size: 0.85rem;
            color: #7f8c8d;
            margin-bottom: 8px;
            font-style: italic;
            display: block;
        }
        
        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group input[type="email"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            background-color: #f9f9f9;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            background-color: white;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }
        
        .inline-fields {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .inline-field {
            flex: 1;
            min-width: 150px;
        }
        
        .checkbox-group, .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .checkbox-item, .radio-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            width: calc(50% - 15px);
        }
        
        .checkbox-item input[type="checkbox"],
        .radio-item input[type="radio"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
        }
        
        .checkbox-item label,
        .radio-item label {
            margin-bottom: 0;
            font-weight: 500;
            cursor: pointer;
        }
        
        .upload-area {
            border: 2px dashed #bdc3c7;
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: #f9f9f9;
            margin-bottom: 15px;
        }
        
        .upload-area:hover {
            border-color: #3498db;
            background-color: #e8f4fc;
            transform: translateY(-2px);
        }
        
        .upload-area i {
            font-size: 2rem;
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        
        .upload-area p {
            margin-bottom: 10px;
            color: #555;
            font-size: 0.95rem;
        }
        
        .upload-area .browse {
            color: #3498db;
            font-weight: 600;
            text-decoration: underline;
        }
        
        .file-input {
            display: none;
        }
        
        .file-list {
            margin-top: 10px;
            list-style-type: none;
        }
        
        .file-list li {
            background-color: #ecf0f1;
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .file-list li:hover {
            background-color: #dfe6e9;
            transform: translateX(5px);
        }
        
        .file-list li i {
            color: #e74c3c;
            cursor: pointer;
            padding: 5px;
            border-radius: 3px;
        }
        
        .file-list li i:hover {
            background-color: #e74c3c;
            color: white;
        }
        
        .required::after {
            content: " *";
            color: #e74c3c;
        }
        
        /* Enhanced Action buttons */
        .action-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid #ecf0f1;
            gap: 15px;
        }
        
        .btn {
            padding: 14px 24px;
            border-radius: 6px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 140px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .btn i {
            margin-right: 10px;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background-color: #95a5a6;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #7f8c8d;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(149, 165, 166, 0.3);
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(46, 204, 113, 0.3);
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            border-top: 1px solid #ecf0f1;
            background-color: #f8f9fa;
            margin-top: 10px;
            flex-shrink: 0;
            font-size: 0.9rem;
        }
        
        .footer a {
            color: #3498db;
            text-decoration: none;
            font-weight: 600;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .app-container {
                height: auto;
                min-height: 100vh;
            }
            
            .main-content {
                flex-direction: column;
                height: auto;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .checkbox-item, .radio-item {
                width: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .inline-fields {
                flex-direction: column;
                gap: 15px;
            }
            
            .preview-container {
                min-height: 300px;
            }
            
            .form-section, .preview-section {
                min-height: 500px;
            }
            
            .progress-container {
                height: 60px;
            }
            
            .progress-line, .progress-fill {
                top: 30px;
            }
            
            .progress-step-circle {
                width: 28px;
                height: 28px;
                font-size: 0.7rem;
            }
            
            .progress-step-label {
                font-size: 0.65rem;
                max-width: 70px;
            }
            
            .form-section-content {
                padding: 20px;
            }
        }
        
        /* Keyboard Navigation */
        input:focus, 
        select:focus, 
        textarea:focus, 
        button:focus {
            outline: 2px solid #3498db;
            outline-offset: 2px;
        }
        
        /* Enhanced Preview Styling */
        .preview-title {
            color: #2c3e50;
            font-size: 1.3rem;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .preview-content {
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .preview-section h3 {
            color: #2c3e50;
            background-color: #ecf0f1;
            padding: 10px 15px;
            border-radius: 6px;
            margin: 20px 0 15px 0;
            font-size: 1rem;
            border-left: 4px solid #3498db;
        }
        
        .preview-section p {
            margin-bottom: 10px;
            padding: 0 5px;
        }
        
        .preview-section strong {
            color: #2c3e50;
            min-width: 180px;
            display: inline-block;
        }
        
        .preview-update {
            text-align: center;
            padding: 12px;
            background: #e8f4fc;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 0.85rem;
            color: #3498db;
            border-left: 4px solid #3498db;
        }
        
        /* Form specific styles */
        .instructions {
            background-color: #e8f4fc;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 6px;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .measurement-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .measurement-item {
            flex: 1;
            min-width: 120px;
        }
        
        .measurement-item label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #555;
        }
        
        .measurement-item input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        
        .stretch-direction {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .stretch-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        
        .stretch-option input {
            margin-right: 8px;
        }
        
        .stretch-option label {
            margin-bottom: 0;
        }
        
        .notching-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 10px;
        }
        
        .notching-option {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: #f9f9f9;
            transition: all 0.2s ease;
        }
        
        .notching-option:hover {
            background-color: #e8f4fc;
            border-color: #3498db;
        }
        
        .notching-option input {
            margin-right: 10px;
        }
        
        /* Enhanced Checklist styling */
        .checklist {
            margin-top: 25px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        .checklist h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px dashed #e0e0e0;
        }
        
        .checklist-item:last-child {
            border-bottom: none;
        }
        
        .checklist-item input {
            margin-right: 12px;
            width: 18px;
            height: 18px;
        }
        
        .checklist-item label {
            font-weight: normal;
            cursor: pointer;
        }
        
        .checklist-item input:checked + label {
            color: #27ae60;
            font-weight: 600;
        }
        
        /* Animation for progress */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .progress-pulse {
            animation: pulse 1.5s infinite;
        }
        
        /* Custom scrollbar */
        .form-section::-webkit-scrollbar,
        .preview-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .form-section::-webkit-scrollbar-track,
        .preview-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .form-section::-webkit-scrollbar-thumb,
        .preview-container::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        .form-section::-webkit-scrollbar-thumb:hover,
        .preview-container::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* Section-specific icons */
        .section-icon {
            margin-right: 12px;
            color: #3498db;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <h1>Universal Pattern Development Request Form</h1>
            
            <!-- Clean Progress Design - Single row only -->
            <div class="progress-container">
                <div class="progress-line"></div>
                <div class="progress-fill" id="progressFill"></div>
                
                <div class="progress-steps">
                    <div class="progress-step" data-step="0">
                        <div class="progress-step-circle active" id="progressStep1">
                            <i class="fas fa-pencil-ruler"></i>
                        </div>
                        <div class="progress-step-label active">Design</div>
                    </div>
                    <div class="progress-step" data-step="1">
                        <div class="progress-step-circle" id="progressStep2">
                            <i class="fas fa-tshirt"></i>
                        </div>
                        <div class="progress-step-label">Fabric</div>
                    </div>
                    <div class="progress-step" data-step="2">
                        <div class="progress-step-circle" id="progressStep3">
                            <i class="fas fa-ruler-combined"></i>
                        </div>
                        <div class="progress-step-label">Sizing</div>
                    </div>
                    <div class="progress-step" data-step="3">
                        <div class="progress-step-circle" id="progressStep4">
                            <i class="fas fa-cut"></i>
                        </div>
                        <div class="progress-step-label">Construction</div>
                    </div>
                    <div class="progress-step" data-step="4">
                        <div class="progress-step-circle" id="progressStep5">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="progress-step-label">Technical</div>
                    </div>
                    <div class="progress-step" data-step="5">
                        <div class="progress-step-circle" id="progressStep6">
                            <i class="fas fa-clipboard-check"></i>
                        </div>
                        <div class="progress-step-label">Review</div>
                    </div>
                </div>
            </div>
            
            <div class="progress-text">Step <span id="progressStep">1</span> of 6: <span id="progressStepName">Design Overview</span></div>
        </div>
        
        <div class="main-content">
            <div class="form-section">
                <!-- Section 1: Design Overview -->
                <div class="form-section-content active" id="section1">
                    <h2 class="section-title">
                        <span class="icon"><i class="fas fa-pencil-ruler"></i></span>
                        Design Overview
                    </h2>
                    
                    <div class="instructions">
                        Please complete each section with details specific to your design. This information will allow a pattern maker to draft or digitize your pattern accurately.
                    </div>
                    
                    <div class="form-group">
                        <label for="garmentType" class="required">Garment Type</label>
                        <select id="garmentType" name="garmentType" required aria-required="true">
                            <option value="">Select garment type</option>
                            <option value="dress">Dress</option>
                            <option value="blouse">Blouse/Shirt</option>
                            <option value="skirt">Skirt</option>
                            <option value="pants">Pants/Trousers</option>
                            <option value="jacket">Jacket/Blazer</option>
                            <option value="leggings">Leggings</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="silhouetteFit" class="required">Silhouette & Fit</label>
                        <textarea id="silhouetteFit" name="silhouetteFit" 
                                  placeholder="e.g., fitted through bodice, relaxed through hip, high-waisted" 
                                  required aria-required="true"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="referenceImages">Reference Images/Sketches</label>
                        <div class="hint">Attach clear front, back, and side views</div>
                        <div class="upload-area" id="referenceUploadArea" tabindex="0" role="button" 
                             aria-label="Upload reference images">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Drag & drop or <span class="browse">click to browse</span></p>
                            <p>Front, back, side views (JPG, PNG, PDF)</p>
                            <input type="file" id="referenceImages" class="file-input" accept=".jpg,.jpeg,.png,.pdf" multiple>
                        </div>
                        <ul class="file-list" id="referenceFileList"></ul>
                    </div>
                    
                    <div class="form-group">
                        <label for="designDetails" class="required">Design Details</label>
                        <div class="hint">Describe or label on sketch: darts, pleats, gathers, seams, closures, topstitching, etc.</div>
                        <textarea id="designDetails" name="designDetails" 
                                  placeholder="Describe your design details..." 
                                  required aria-required="true"></textarea>
                    </div>
                    
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary" id="clearForm" aria-label="Clear all form fields">
                            <i class="fas fa-redo"></i> Clear All
                        </button>
                        <button type="button" class="btn btn-primary" id="next1" aria-label="Go to next section">
                            Next: Fabric Information <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Section 2: Fabric Information -->
                <div class="form-section-content" id="section2">
                    <h2 class="section-title">
                        <span class="icon"><i class="fas fa-tshirt"></i></span>
                        Fabric Information
                    </h2>
                    
                    <div class="form-group">
                        <label for="fabricType" class="required">Fabric Type</label>
                        <input type="text" id="fabricType" name="fabricType" 
                               placeholder="e.g., woven cotton, 4-way stretch knit, denim" 
                               required aria-required="true">
                    </div>
                    
                    <div class="form-group">
                        <label for="fabricWeight" class="required">Weight & Hand Feel</label>
                        <input type="text" id="fabricWeight" name="fabricWeight" 
                               placeholder="e.g., lightweight and drapey, medium-weight and structured" 
                               required aria-required="true">
                    </div>
                    
                    <div class="inline-fields">
                        <div class="inline-field">
                            <label for="stretchPercentage">Stretch Percentage</label>
                            <input type="number" id="stretchPercentage" name="stretchPercentage" 
                                   min="0" max="100" placeholder="e.g., 20">
                        </div>
                        <div class="inline-field">
                            <label>Stretch Direction</label>
                            <div class="stretch-direction">
                                <div class="stretch-option">
                                    <input type="checkbox" id="stretchLengthwise" name="stretchDirection" value="Lengthwise">
                                    <label for="stretchLengthwise">Lengthwise</label>
                                </div>
                                <div class="stretch-option">
                                    <input type="checkbox" id="stretchCrosswise" name="stretchDirection" value="Crosswise">
                                    <label for="stretchCrosswise">Crosswise</label>
                                </div>
                                <div class="stretch-option">
                                    <input type="checkbox" id="stretchBoth" name="stretchDirection" value="Both/4-way">
                                    <label for="stretchBoth">Both/4-way</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="fabricNotes">Special Notes</label>
                        <textarea id="fabricNotes" name="fabricNotes" 
                                  placeholder="e.g., requires pre-washing, has nap/directional print, slippery"></textarea>
                    </div>
                    
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary" id="prev2" aria-label="Go to previous section">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" id="next2" aria-label="Go to next section">
                            Next: Sizing & Measurements <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Section 3: Sizing & Measurements -->
                <div class="form-section-content" id="section3">
                    <h2 class="section-title">
                        <span class="icon"><i class="fas fa-ruler-combined"></i></span>
                        Sizing & Measurements
                    </h2>
                    
                    <div class="form-group">
                        <label for="baseSize" class="required">Base Size</label>
                        <input type="text" id="baseSize" name="baseSize" 
                               placeholder="e.g., Women's US 8, Men's Medium" 
                               required aria-required="true">
                    </div>
                    
                    <div class="form-group">
                        <label>Garment Measurements Provided</label>
                        <div class="measurement-row">
                            <div class="measurement-item">
                                <label for="bustMeasure">Bust</label>
                                <input type="text" id="bustMeasure" name="bustMeasure" placeholder="inches/cm">
                            </div>
                            <div class="measurement-item">
                                <label for="waistMeasure">Waist</label>
                                <input type="text" id="waistMeasure" name="waistMeasure" placeholder="inches/cm">
                            </div>
                            <div class="measurement-item">
                                <label for="hipMeasure">Hip</label>
                                <input type="text" id="hipMeasure" name="hipMeasure" placeholder="inches/cm">
                            </div>
                        </div>
                        <div class="measurement-row">
                            <div class="measurement-item">
                                <label for="lengthMeasure">Length</label>
                                <input type="text" id="lengthMeasure" name="lengthMeasure" placeholder="inches/cm">
                            </div>
                            <div class="measurement-item">
                                <label for="sleeveMeasure">Sleeve</label>
                                <input type="text" id="sleeveMeasure" name="sleeveMeasure" placeholder="inches/cm">
                            </div>
                            <div class="measurement-item">
                                <label for="otherMeasure">Other</label>
                                <input type="text" id="otherMeasure" name="otherMeasure" placeholder="inches/cm">
                            </div>
                        </div>
                    </div>
                    
                    <div class="inline-fields">
                        <div class="inline-field">
                            <label for="easeWovens">Ease for Wovens</label>
                            <input type="text" id="easeWovens" name="easeWovens" 
                                   placeholder="e.g., 2&quot; ease at bust, 1.5&quot; at waist">
                        </div>
                        <div class="inline-field">
                            <label for="easeKnits">Ease for Knits</label>
                            <input type="text" id="easeKnits" name="easeKnits" 
                                   placeholder="e.g., 0&quot; ease at bust [negative ease], 1&quot; ease at hip">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Size Grading Needed?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="gradingYes" name="sizeGrading" value="yes">
                                <label for="gradingYes">Yes – attach size chart</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="gradingNo" name="sizeGrading" value="no">
                                <label for="gradingNo">No – single size only</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="sizeChart">Size Chart Upload (if applicable)</label>
                        <div class="upload-area" id="sizeChartUploadArea" tabindex="0" role="button" 
                             aria-label="Upload size chart">
                            <i class="fas fa-file-upload"></i>
                            <p>Drag & drop or <span class="browse">click to browse</span></p>
                            <p>Size chart file (PDF, Excel, Image)</p>
                            <input type="file" id="sizeChart" class="file-input" accept=".jpg,.jpeg,.png,.pdf,.xlsx,.xls">
                        </div>
                        <ul class="file-list" id="sizeChartFileList"></ul>
                    </div>
                    
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary" id="prev3" aria-label="Go to previous section">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" id="next3" aria-label="Go to next section">
                            Next: Construction Details <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Section 4: Construction Details -->
                <div class="form-section-content" id="section4">
                    <h2 class="section-title">
                        <span class="icon"><i class="fas fa-cut"></i></span>
                        Construction Details
                    </h2>
                    
                    <div class="form-group">
                        <label for="seamAllowance" class="required">Seam Allowance</label>
                        <input type="text" id="seamAllowance" name="seamAllowance" 
                               placeholder="e.g., Standard ⅝&quot; overall, ¼&quot; for collars" 
                               required aria-required="true">
                    </div>
                    
                    <div class="form-group">
                        <label for="hemStyle" class="required">Hem Style & Width</label>
                        <input type="text" id="hemStyle" name="hemStyle" 
                               placeholder="e.g., 1.5&quot; double-fold hem, faced hem, raw edge with binding" 
                               required aria-required="true">
                    </div>
                    
                    <div class="form-group">
                        <label for="closures" class="required">Closures</label>
                        <textarea id="closures" name="closures" 
                                  placeholder="Type, size, placement: e.g., 14&quot; invisible zipper at center back, button placket with 1&quot; buttons" 
                                  required aria-required="true"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="liningFacing" class="required">Lining/Facing/Interfacing</label>
                        <textarea id="liningFacing" name="liningFacing" 
                                  placeholder="Indicate areas if needed: e.g., full lining, front facing only, interfacing at collar" 
                                  required aria-required="true"></textarea>
                    </div>
                    
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary" id="prev4" aria-label="Go to previous section">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" id="next4" aria-label="Go to next section">
                            Next: Technical Requirements <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Section 5: Technical Requirements -->
                <div class="form-section-content" id="section5">
                    <h2 class="section-title">
                        <span class="icon"><i class="fas fa-cogs"></i></span>
                        Technical Requirements
                    </h2>
                    
                    <div class="form-group">
                        <label for="grainlineDirection">Grainline Direction</label>
                        <textarea id="grainlineDirection" name="grainlineDirection" 
                                  placeholder="Indicate on sketch, especially for stripes/plaids/napped fabrics"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Notching System</label>
                        <div class="notching-options">
                            <div class="notching-option">
                                <input type="radio" id="notchSlit" name="notchingSystem" value="Slit Notch">
                                <label for="notchSlit">Slit Notch (single cut)</label>
                            </div>
                            <div class="notching-option">
                                <input type="radio" id="notchV" name="notchingSystem" value="V Notch">
                                <label for="notchV">V Notch (triangular cut outward)</label>
                            </div>
                            <div class="notching-option">
                                <input type="radio" id="notchCastle" name="notchingSystem" value="Castle Notch">
                                <label for="notchCastle">Castle Notch (U-shaped/rectangular)</label>
                            </div>
                            <div class="notching-option">
                                <input type="radio" id="notchInverted" name="notchingSystem" value="Inverted V Notch">
                                <label for="notchInverted">Inverted V Notch (triangular cut inward)</label>
                            </div>
                            <div class="notching-option">
                                <input type="radio" id="notchCustom" name="notchingSystem" value="Custom">
                                <label for="notchCustom">Custom</label>
                            </div>
                            <div class="notching-option">
                                <input type="radio" id="notchStandard" name="notchingSystem" value="Standard">
                                <label for="notchStandard">No preference – pattern maker's standard</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="customNotching">Custom Notching Description (if selected)</label>
                        <input type="text" id="customNotching" name="customNotching" 
                               placeholder="Describe custom notching system">
                    </div>
                    
                    <div class="form-group">
                        <label for="patternLabels">Pattern Labels Required</label>
                        <textarea id="patternLabels" name="patternLabels" 
                                  placeholder="e.g., piece name, size, cut quantity, fabric type"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Final File Format Needed</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="formatPDF" name="fileFormat" value="PDF">
                                <label for="formatPDF">.PDF (for printing)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="formatDXF" name="fileFormat" value="DXF">
                                <label for="formatDXF">.DXF (for digital cutting)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="formatAI" name="fileFormat" value="AI">
                                <label for="formatAI">.AI (Adobe Illustrator)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="formatOther" name="fileFormat" value="Other">
                                <label for="formatOther">Other format</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="otherFormat">Other Format (specify)</label>
                        <input type="text" id="otherFormat" name="otherFormat" 
                               placeholder="e.g., .SVG, .PAT">
                    </div>
                    
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary" id="prev5" aria-label="Go to previous section">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" id="next5" aria-label="Go to next section">
                            Next: Special Notes & Review <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Section 6: Special Notes & Fit Considerations -->
                <div class="form-section-content" id="section6">
                    <h2 class="section-title">
                        <span class="icon"><i class="fas fa-clipboard-check"></i></span>
                        Special Notes & Review
                    </h2>
                    
                    <div class="form-group">
                        <label for="targetCustomer">Target Customer/Body Type</label>
                        <textarea id="targetCustomer" name="targetCustomer" 
                                  placeholder="e.g., petite, tall, athletic build, full bust"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="fitAdjustments">Common Fit Adjustments</label>
                        <textarea id="fitAdjustments" name="fitAdjustments" 
                                  placeholder="e.g., rounded back adjustment, forward shoulder"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="otherNotes">Other Notes</label>
                        <textarea id="otherNotes" name="otherNotes" 
                                  placeholder="Any critical tolerances, branding labels, or construction preferences"></textarea>
                    </div>
                    
                    <div class="checklist">
                        <h3>Final Submission Checklist</h3>
                        <div class="checklist-item">
                            <input type="checkbox" id="check1" name="checklist">
                            <label for="check1">All sketches/images attached and labeled</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check2" name="checklist">
                            <label for="check2">All measurements and sizing details provided</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check3" name="checklist">
                            <label for="check3">Fabric information and stretch details confirmed</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check4" name="checklist">
                            <label for="check4">Construction and finishing details specified</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check5" name="checklist">
                            <label for="check5">Preferred output format selected</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check6" name="checklist">
                            <label for="check6">Contact information and timeline included</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="contactInfo" class="required">Contact Information</label>
                        <textarea id="contactInfo" name="contactInfo" 
                                  placeholder="Name, email, phone, company (if applicable)" 
                                  required aria-required="true"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeline" class="required">Project Timeline</label>
                        <input type="text" id="timeline" name="timeline" 
                               placeholder="e.g., Within 2 weeks, Urgent, No rush" 
                               required aria-required="true">
                    </div>
                    
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary" id="prev6" aria-label="Go to previous section">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-success" id="submitForm" aria-label="Submit pattern request">
                            <i class="fas fa-paper-plane"></i> Submit Request
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="preview-section">
                <h2 class="preview-title">Form Preview</h2>
                <div class="preview-container" id="previewContainer">
                    <div class="preview-content" id="previewContent">
                        <h3>Universal Pattern Development Request Form</h3>
                        <p><strong>Current Step:</strong> <span id="previewStep">Design Overview</span></p>
                        <p><strong>Progress:</strong> <span id="previewProgress">1 of 6</span></p>
                        
                        <h3>Design Overview</h3>
                        <p><strong>Garment Type:</strong> <span id="previewGarment">Not specified</span></p>
                        <p><strong>Silhouette & Fit:</strong> <span id="previewFit">Not specified</span></p>
                        <p><strong>Design Details:</strong> <span id="previewDesign">Not specified</span></p>
                        
                        <h3>Fabric Information</h3>
                        <p><strong>Fabric Type:</strong> <span id="previewFabric">Not specified</span></p>
                        <p><strong>Weight & Hand Feel:</strong> <span id="previewWeight">Not specified</span></p>
                        <p><strong>Stretch:</strong> <span id="previewStretch">Not specified</span></p>
                        
                        <h3>Sizing & Measurements</h3>
                        <p><strong>Base Size:</strong> <span id="previewSize">Not specified</span></p>
                        <p><strong>Bust:</strong> <span id="previewBust">Not specified</span></p>
                        <p><strong>Waist:</strong> <span id="previewWaist">Not specified</span></p>
                        
                        <h3>Construction Details</h3>
                        <p><strong>Seam Allowance:</strong> <span id="previewSeam">Not specified</span></p>
                        <p><strong>Hem Style:</strong> <span id="previewHem">Not specified</span></p>
                        
                        <h3>Technical Requirements</h3>
                        <p><strong>File Formats:</strong> <span id="previewFormats">Not specified</span></p>
                        <p><strong>Notching System:</strong> <span id="previewNotching">Not specified</span></p>
                        
                        <h3>Special Notes</h3>
                        <p><strong>Target Customer:</strong> <span id="previewTarget">Not specified</span></p>
                        <p><strong>Fit Adjustments:</strong> <span id="previewAdjustments">Not specified</span></p>
                        
                        <div class="preview-update">
                            <i class="fas fa-sync-alt"></i> Preview updates as you complete the form
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons" style="margin-top: 15px; border-top: none;">
                    <button type="button" class="btn btn-primary" id="updatePreview" aria-label="Refresh preview">
                        <i class="fas fa-sync"></i> Refresh Preview
                    </button>
                    <button type="button" class="btn btn-success" id="downloadPDF" aria-label="Download PDF version">
                        <i class="fas fa-file-pdf"></i> Download PDF
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Once completed, submit this form along with your sketches and any reference samples to your pattern maker.</p>
            <p>Need assistance? Contact: <a href="mailto:patterns@example.com">patterns@example.com</a></p>
        </div>
    </div>

    <script>
        // DOM elements
        const sections = document.querySelectorAll('.form-section-content');
        const progressSteps = document.querySelectorAll('.progress-step');
        const progressStepCircles = document.querySelectorAll('.progress-step-circle');
        const progressStepLabels = document.querySelectorAll('.progress-step-label');
        let currentSection = 0;
        const totalSections = 6;
        
        // Progress elements
        const progressFill = document.getElementById('progressFill');
        const progressStepText = document.getElementById('progressStep');
        const progressStepName = document.getElementById('progressStepName');
        
        // Form elements
        const form = {
            garmentType: document.getElementById('garmentType'),
            silhouetteFit: document.getElementById('silhouetteFit'),
            designDetails: document.getElementById('designDetails'),
            fabricType: document.getElementById('fabricType'),
            fabricWeight: document.getElementById('fabricWeight'),
            stretchPercentage: document.getElementById('stretchPercentage'),
            stretchLengthwise: document.getElementById('stretchLengthwise'),
            stretchCrosswise: document.getElementById('stretchCrosswise'),
            stretchBoth: document.getElementById('stretchBoth'),
            fabricNotes: document.getElementById('fabricNotes'),
            baseSize: document.getElementById('baseSize'),
            bustMeasure: document.getElementById('bustMeasure'),
            waistMeasure: document.getElementById('waistMeasure'),
            hipMeasure: document.getElementById('hipMeasure'),
            lengthMeasure: document.getElementById('lengthMeasure'),
            sleeveMeasure: document.getElementById('sleeveMeasure'),
            otherMeasure: document.getElementById('otherMeasure'),
            easeWovens: document.getElementById('easeWovens'),
            easeKnits: document.getElementById('easeKnits'),
            gradingYes: document.getElementById('gradingYes'),
            gradingNo: document.getElementById('gradingNo'),
            seamAllowance: document.getElementById('seamAllowance'),
            hemStyle: document.getElementById('hemStyle'),
            closures: document.getElementById('closures'),
            liningFacing: document.getElementById('liningFacing'),
            grainlineDirection: document.getElementById('grainlineDirection'),
            notchSlit: document.getElementById('notchSlit'),
            notchV: document.getElementById('notchV'),
            notchCastle: document.getElementById('notchCastle'),
            notchInverted: document.getElementById('notchInverted'),
            notchCustom: document.getElementById('notchCustom'),
            notchStandard: document.getElementById('notchStandard'),
            customNotching: document.getElementById('customNotching'),
            patternLabels: document.getElementById('patternLabels'),
            formatPDF: document.getElementById('formatPDF'),
            formatDXF: document.getElementById('formatDXF'),
            formatAI: document.getElementById('formatAI'),
            formatOther: document.getElementById('formatOther'),
            otherFormat: document.getElementById('otherFormat'),
            targetCustomer: document.getElementById('targetCustomer'),
            fitAdjustments: document.getElementById('fitAdjustments'),
            otherNotes: document.getElementById('otherNotes'),
            contactInfo: document.getElementById('contactInfo'),
            timeline: document.getElementById('timeline')
        };
        
        // Step names for display
        const stepNames = [
            "Design Overview",
            "Fabric Information", 
            "Sizing & Measurements",
            "Construction Details",
            "Technical Requirements",
            "Special Notes & Review"
        ];
        
        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Setup file upload
            setupFileUpload('referenceUploadArea', 'referenceImages', 'referenceFileList');
            setupFileUpload('sizeChartUploadArea', 'sizeChart', 'sizeChartFileList');
            
            // Setup navigation
            setupNavigation();
            
            // Setup form handlers
            setupFormHandlers();
            
            // Update progress display
            updateProgressDisplay();
            
            // Setup real-time preview updates
            setupRealTimePreview();
            
            // Set initial progress
            updateProgress(0);
            
            // Focus first input for keyboard users
            setTimeout(() => {
                form.garmentType.focus();
            }, 100);
        });
        
        // Setup file upload functionality
        function setupFileUpload(uploadAreaId, fileInputId, fileListId) {
            const uploadArea = document.getElementById(uploadAreaId);
            const fileInput = document.getElementById(fileInputId);
            const fileList = document.getElementById(fileListId);
            
            if (!uploadArea || !fileInput || !fileList) return;
            
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    fileInput.click();
                }
            });
            
            fileInput.addEventListener('change', function(e) {
                handleFiles(e.target.files, fileList);
                fileInput.value = '';
            });
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#3498db';
                uploadArea.style.backgroundColor = '#e8f4fc';
                uploadArea.style.transform = 'translateY(-5px)';
            });
            
            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#bdc3c7';
                uploadArea.style.backgroundColor = '#f9f9f9';
                uploadArea.style.transform = 'translateY(0)';
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#bdc3c7';
                uploadArea.style.backgroundColor = '#f9f9f9';
                uploadArea.style.transform = 'translateY(0)';
                if (e.dataTransfer.files.length) {
                    handleFiles(e.dataTransfer.files, fileList);
                }
            });
        }
        
        // Handle uploaded files
        function handleFiles(files, fileList) {
            for (let file of files) {
                const listItem = document.createElement('li');
                let displayName = file.name.length > 30 ? file.name.substring(0, 27) + '...' : file.name;
                
                listItem.innerHTML = `
                    <span>${displayName} (${formatFileSize(file.size)})</span>
                    <i class="fas fa-times" aria-label="Remove file"></i>
                `;
                
                fileList.appendChild(listItem);
                listItem.querySelector('i').addEventListener('click', () => listItem.remove());
            }
        }
        
        // Format file size
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' bytes';
            else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
            else return (bytes / 1048576).toFixed(1) + ' MB';
        }
        
        // Setup navigation
        function setupNavigation() {
            // Next buttons
            document.getElementById('next1').addEventListener('click', () => navigateTo(1));
            document.getElementById('next2').addEventListener('click', () => navigateTo(2));
            document.getElementById('next3').addEventListener('click', () => navigateTo(3));
            document.getElementById('next4').addEventListener('click', () => navigateTo(4));
            document.getElementById('next5').addEventListener('click', () => navigateTo(5));
            
            // Previous buttons
            document.getElementById('prev2').addEventListener('click', () => navigateTo(0));
            document.getElementById('prev3').addEventListener('click', () => navigateTo(1));
            document.getElementById('prev4').addEventListener('click', () => navigateTo(2));
            document.getElementById('prev5').addEventListener('click', () => navigateTo(3));
            document.getElementById('prev6').addEventListener('click', () => navigateTo(4));
            
            // Progress steps click
            progressSteps.forEach((step, index) => {
                step.addEventListener('click', () => navigateTo(index));
            });
        }
        
        // Navigate to section
        function navigateTo(sectionIndex) {
            // Validate current section
            if (sectionIndex > currentSection && !validateCurrentSection()) return;
            
            currentSection = sectionIndex;
            
            // Hide all sections
            sections.forEach(section => section.classList.remove('active'));
            
            // Show selected section
            sections[sectionIndex].classList.add('active');
            
            // Update progress
            updateProgress(sectionIndex);
            
            // Update progress steps
            updateProgressSteps(sectionIndex);
            
            // Scroll to top
            document.querySelector('.form-section').scrollTop = 0;
            
            // Focus first input in section for keyboard users
            setTimeout(() => {
                const firstInput = sections[sectionIndex].querySelector('input, select, textarea');
                if (firstInput) firstInput.focus();
            }, 100);
        }
        
        // Update progress display
        function updateProgress(currentStep) {
            // Calculate percentage for progress bar
            const percentage = (currentStep / (totalSections - 1)) * 100;
            
            // Update main progress bar
            progressFill.style.width = percentage + '%';
            
            // Update step text
            progressStepText.textContent = currentStep + 1;
            progressStepName.textContent = stepNames[currentStep];
            
            // Update preview
            document.getElementById('previewStep').textContent = stepNames[currentStep];
            document.getElementById('previewProgress').textContent = (currentStep + 1) + ' of 6';
        }
        
        // Update progress steps in header
        function updateProgressSteps(currentIndex) {
            progressStepCircles.forEach((circle, index) => {
                circle.classList.remove('active', 'completed');
                progressStepLabels[index].classList.remove('active', 'completed');
                
                if (index === currentIndex) {
                    circle.classList.add('active');
                    progressStepLabels[index].classList.add('active');
                } else if (index < currentIndex) {
                    circle.classList.add('completed');
                    progressStepLabels[index].classList.add('completed');
                }
            });
        }
        
        // Validate current section
        function validateCurrentSection() {
            const currentSectionEl = sections[currentSection];
            const requiredInputs = currentSectionEl.querySelectorAll('[required]');
            
            for (let input of requiredInputs) {
                if (!input.value.trim()) {
                    alert(`Please complete all required fields in this section before continuing.`);
                    input.focus();
                    return false;
                }
            }
            
            return true;
        }
        
        // Setup form handlers
        function setupFormHandlers() {
            // Clear form
            document.getElementById('clearForm').addEventListener('click', function() {
                if (confirm('Are you sure you want to clear all form fields?')) {
                    // Reset all form elements
                    Object.values(form).forEach(element => {
                        if (element) {
                            if (element.type === 'checkbox' || element.type === 'radio') {
                                element.checked = false;
                            } else {
                                element.value = '';
                            }
                        }
                    });
                    
                    // Clear file lists
                    document.getElementById('referenceFileList').innerHTML = '';
                    document.getElementById('sizeChartFileList').innerHTML = '';
                    
                    // Clear checklist
                    document.querySelectorAll('input[name="checklist"]').forEach(cb => cb.checked = false);
                    
                    // Go back to first section
                    navigateTo(0);
                    
                    // Reset preview
                    updatePreview();
                    
                    alert('Form cleared successfully!');
                }
            });
            
            // Submit form
            document.getElementById('submitForm').addEventListener('click', function() {
                // Validate checklist
                const checklistItems = document.querySelectorAll('input[name="checklist"]');
                let allChecked = true;
                
                checklistItems.forEach(item => {
                    if (!item.checked) allChecked = false;
                });
                
                if (!allChecked) {
                    alert('Please check all items in the Final Submission Checklist before submitting.');
                    return;
                }
                
                if (validateAllSections()) {
                    // Generate PDF
                    generatePDF();
                    
                    // Show success message
                    alert('Pattern request submitted successfully! A PDF preview has been downloaded.');
                    
                    // In real app, submit to server
                    console.log('Form submitted:', collectFormData());
                }
            });
            
            // Update preview button
            document.getElementById('updatePreview').addEventListener('click', updatePreview);
            
            // Download PDF button
            document.getElementById('downloadPDF').addEventListener('click', generatePDF);
            
            // Show/hide custom notching field
            document.getElementById('notchCustom').addEventListener('change', function() {
                document.getElementById('customNotching').style.display = this.checked ? 'block' : 'none';
            });
            
            // Show/hide other format field
            document.getElementById('formatOther').addEventListener('change', function() {
                document.getElementById('otherFormat').style.display = this.checked ? 'block' : 'none';
            });
            
            // Initially hide these fields
            document.getElementById('customNotching').style.display = 'none';
            document.getElementById('otherFormat').style.display = 'none';
        }
        
        // Setup real-time preview updates
        function setupRealTimePreview() {
            // Add input event listeners to all form fields
            Object.values(form).forEach(element => {
                if (element && element.addEventListener) {
                    if (element.type === 'checkbox' || element.type === 'radio') {
                        element.addEventListener('change', updatePreview);
                    } else {
                        element.addEventListener('input', updatePreview);
                    }
                }
            });
            
            // Also update on file changes
            document.getElementById('referenceFileList').addEventListener('DOMNodeInserted', updatePreview);
            document.getElementById('referenceFileList').addEventListener('DOMNodeRemoved', updatePreview);
            document.getElementById('sizeChartFileList').addEventListener('DOMNodeInserted', updatePreview);
            document.getElementById('sizeChartFileList').addEventListener('DOMNodeRemoved', updatePreview);
            
            // Update on checklist changes
            document.querySelectorAll('input[name="checklist"]').forEach(cb => {
                cb.addEventListener('change', updatePreview);
            });
        }
        
        // Update preview
        function updatePreview() {
            const data = collectFormData();
            
            // Update preview elements
            document.getElementById('previewGarment').textContent = data.garmentType || 'Not specified';
            document.getElementById('previewFit').textContent = data.silhouetteFit || 'Not specified';
            document.getElementById('previewDesign').textContent = data.designDetails || 'Not specified';
            document.getElementById('previewFabric').textContent = data.fabricType || 'Not specified';
            document.getElementById('previewWeight').textContent = data.fabricWeight || 'Not specified';
            
            let stretchText = '';
            if (data.stretchPercentage) stretchText += data.stretchPercentage + '% ';
            if (data.stretchDirection && data.stretchDirection.length > 0) {
                stretchText += '(' + data.stretchDirection.join(', ') + ')';
            }
            document.getElementById('previewStretch').textContent = stretchText || 'Not specified';
            
            document.getElementById('previewSize').textContent = data.baseSize || 'Not specified';
            document.getElementById('previewBust').textContent = data.bustMeasure || 'Not specified';
            document.getElementById('previewWaist').textContent = data.waistMeasure || 'Not specified';
            document.getElementById('previewHip').textContent = data.hipMeasure || 'Not specified';
            document.getElementById('previewSeam').textContent = data.seamAllowance || 'Not specified';
            document.getElementById('previewHem').textContent = data.hemStyle || 'Not specified';
            document.getElementById('previewClosures').textContent = data.closures || 'Not specified';
            document.getElementById('previewFormats').textContent = data.fileFormats || 'Not specified';
            document.getElementById('previewNotching').textContent = data.notchingSystem || 'Not specified';
            document.getElementById('previewTarget').textContent = data.targetCustomer || 'Not specified';
            document.getElementById('previewAdjustments').textContent = data.fitAdjustments || 'Not specified';
        }
        
        // Validate all sections
        function validateAllSections() {
            for (let i = 0; i < sections.length; i++) {
                const section = sections[i];
                const requiredInputs = section.querySelectorAll('[required]');
                
                for (let input of requiredInputs) {
                    if (!input.value.trim()) {
                        alert(`Please complete all required fields in section ${i + 1} before submitting.`);
                        navigateTo(i);
                        input.focus();
                        return false;
                    }
                }
            }
            
            return true;
        }
        
        // Collect form data
        function collectFormData() {
            const data = {};
            
            // Get values from form elements
            for (const [key, element] of Object.entries(form)) {
                if (element) {
                    if (element.type === 'checkbox' || element.type === 'radio') {
                        if (element.checked) {
                            if (key.startsWith('stretch')) {
                                if (!data.stretchDirection) data.stretchDirection = [];
                                data.stretchDirection.push(element.value);
                            } else if (key.startsWith('notch')) {
                                data.notchingSystem = element.value;
                            } else if (key.startsWith('format')) {
                                if (!data.fileFormats) data.fileFormats = [];
                                data.fileFormats.push(element.value);
                            } else if (key === 'gradingYes' || key === 'gradingNo') {
                                data.sizeGrading = element.value;
                            } else {
                                data[key] = element.value;
                            }
                        }
                    } else {
                        data[key] = element.value.trim();
                    }
                }
            }
            
            // Get file counts
            const referenceFileList = document.getElementById('referenceFileList');
            const sizeChartFileList = document.getElementById('sizeChartFileList');
            data.referenceFileCount = referenceFileList.children.length;
            data.sizeChartFileCount = sizeChartFileList.children.length;
            
            // Get checklist status
            const checklistItems = document.querySelectorAll('input[name="checklist"]');
            data.checklistCompleted = Array.from(checklistItems).every(item => item.checked);
            
            // Format file formats as string
            if (data.fileFormats && data.fileFormats.length > 0) {
                data.fileFormats = data.fileFormats.join(', ');
            }
            
            // Format stretch direction as string
            if (data.stretchDirection && data.stretchDirection.length > 0) {
                data.stretchDirection = data.stretchDirection.join(', ');
            }
            
            return data;
        }
        
        // Generate PDF
        function generatePDF() {
            const data = collectFormData();
            const date = new Date().toLocaleDateString();
            
            // Create PDF content
            const pdfContent = `
                UNIVERSAL PATTERN DEVELOPMENT REQUEST FORM
                ===========================================
                Submitted: ${date}
                
                1. DESIGN OVERVIEW
                ------------------
                Garment Type: ${data.garmentType || 'Not specified'}
                Silhouette & Fit: ${data.silhouetteFit || 'Not specified'}
                Design Details: ${data.designDetails || 'Not specified'}
                Reference Images: ${data.referenceFileCount || 0} file(s) attached
                
                2. FABRIC INFORMATION
                ---------------------
                Fabric Type: ${data.fabricType || 'Not specified'}
                Weight & Hand Feel: ${data.fabricWeight || 'Not specified'}
                Stretch Percentage: ${data.stretchPercentage || '0'}%
                Stretch Direction: ${data.stretchDirection || 'Not specified'}
                Special Notes: ${data.fabricNotes || 'None'}
                
                3. SIZING & MEASUREMENTS
                -------------------------
                Base Size: ${data.baseSize || 'Not specified'}
                Bust: ${data.bustMeasure || 'Not specified'}
                Waist: ${data.waistMeasure || 'Not specified'}
                Hip: ${data.hipMeasure || 'Not specified'}
                Length: ${data.lengthMeasure || 'Not specified'}
                Sleeve: ${data.sleeveMeasure || 'Not specified'}
                Other: ${data.otherMeasure || 'Not specified'}
                Ease (Wovens): ${data.easeWovens || 'Not specified'}
                Ease (Knits): ${data.easeKnits || 'Not specified'}
                Size Grading: ${data.sizeGrading === 'yes' ? 'Yes - size chart attached' : 'No - single size only'}
                Size Chart Files: ${data.sizeChartFileCount || 0} file(s) attached
                
                4. CONSTRUCTION DETAILS
                -----------------------
                Seam Allowance: ${data.seamAllowance || 'Not specified'}
                Hem Style & Width: ${data.hemStyle || 'Not specified'}
                Closures: ${data.closures || 'Not specified'}
                Lining/Facing/Interfacing: ${data.liningFacing || 'Not specified'}
                
                5. TECHNICAL REQUIREMENTS
                --------------------------
                Grainline Direction: ${data.grainlineDirection || 'Not specified'}
                Notching System: ${data.notchingSystem || 'Pattern maker\'s standard'}
                Custom Notching: ${data.customNotching || 'N/A'}
                Pattern Labels Required: ${data.patternLabels || 'Not specified'}
                Final File Format Needed: ${data.fileFormats || 'Not specified'}
                Other Format: ${data.otherFormat || 'N/A'}
                
                6. SPECIAL NOTES & FIT CONSIDERATIONS
                --------------------------------------
                Target Customer/Body Type: ${data.targetCustomer || 'Not specified'}
                Common Fit Adjustments: ${data.fitAdjustments || 'Not specified'}
                Other Notes: ${data.otherNotes || 'None'}
                
                CONTACT & TIMELINE
                ------------------
                Contact Information: ${data.contactInfo || 'Not specified'}
                Project Timeline: ${data.timeline || 'Not specified'}
                
                FINAL SUBMISSION CHECKLIST
                --------------------------
                Checklist Complete: ${data.checklistCompleted ? 'YES' : 'NO'}
                
                ===========================================
                Generated: ${new Date().toLocaleString()}
                Form ID: PAT-${Date.now().toString().slice(-6)}
            `;
            
            // Create downloadable file
            const blob = new Blob([pdfContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `PatternRequest_${date.replace(/\//g, '-')}_${Date.now().toString().slice(-4)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Tab navigation between sections with Ctrl+Arrow keys
            if (e.ctrlKey) {
                if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (currentSection < totalSections - 1) {
                        navigateTo(currentSection + 1);
                    }
                } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (currentSection > 0) {
                        navigateTo(currentSection - 1);
                    }
                }
            }
            
            // Submit with Ctrl+Enter
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                document.getElementById('submitForm').click();
            }
        });
    </script>
</body>
</html>